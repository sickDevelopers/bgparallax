/**
 * 
 * FullParallax jquery plugin
 *
 * Author: Oscar Chinellato
 * Version: 0.3
 *
 * Date: 2013.05.31
 *
 * Released undem MIT Licence
 * 
 */(function(e,t,n,r){function o(t,n){this.element=t;this.$element=e(t);this.options=e.extend({},s,n);this._defaults=s;this._name=i;this.update_rate=1e3/this.options.frame_per_second;this.x_cursor=0;this.y_cursor=0;this.docDim={height:e(r).height(),width:e(r).width()};this.layers=[];this.init()}var i="fullparallax",s={frame_per_second:20};o.prototype.init=function(){var t=this;this.$element.find("div").each(function(n,r){var i=e(this),s=0,o=0,u=0,a=0;if(i.data("size")){var f=i.data("size").split(";"),l=f[0]?f[0].split(":")[1]:"auto",c=f[1]?f[1].split(":")[1]:"auto";l.indexOf("%")>-1?u=t.$element.width()/100*l.split("%")[0]:u=l.split("px")[0];c.indexOf("%")>-1?a=t.$element.height()/100*c.split("%")[0]:a=c.split("px")[0]}if(i.data("position")){var h=i.data("position").split(";"),p=h[0]?h[0].split(":")[1]:"0",d=h[1]?h[1].split(":")[1]:"0";p.indexOf("%")>-1?s=t.$element.width()/100*p.split("%")[0]:s=p.split("px")[0];d.indexOf("%")>-1?o=t.$element.height()/100*d.split("%")[0]:o=d.split("px")[0]}var v={HTMLobj:i,order:n,pxBgWidth:u,pxBgHeight:a,pxBgX:s,pxBgY:o,src:i.data("src"),xrange:i.data("x-range")||20,yrange:i.data("y-range")||20};t.layers.push(v);i.css({backgroundSize:u+v.xrange*2,backgroundPosition:"0 0",backgroundRepeat:"no-repeat",position:"relative",marginTop:v.order===0?0:-t.$element.height()})});this.$element.append(e('<div class="fp-loading"></div>').css({marginTop:-this.$element.height()/2-20}));this.preloadImages();e(r).mousemove(function(e){t.x_cursor=e.pageX;t.y_cursor=e.pageY})};o.prototype.preloadImages=function(){var t=this,n=[];for(var r=0;r<this.layers.length;r++){var i=new Image;i.src=this.layers[r].src;i.i=r;i.onload=function(){t.layers[this.i].HTMLobj.css({backgroundImage:"url("+this.src+")"});t.layers[this.i].HTMLobj.fadeIn();n.push(this);if(n.length===t.layers.length){e(".fp-loading").fadeOut();t.main_interval=setInterval(function(){t.update()},t.update_rate)}}}};o.prototype.update=function(){var e=this.docDim.width/2-this.x_cursor,t=this.docDim.height/2-this.y_cursor;for(var n=0;n<this.layers.length;n++){var r=this.layers[n],i=this.docDim.width/2/r.xrange,s=this.docDim.height/2/r.yrange,o=this.layers[n].pxBgX-r.xrange+e/i,u=this.layers[n].pxBgY-r.yrange+t/s,a=o+"px "+u+"px";r.HTMLobj.css({backgroundPosition:a})}};e.fn[i]=function(t){return this.each(function(){e.data(this,"plugin_"+i)||e.data(this,"plugin_"+i,new o(this,t))})}})(jQuery,undefined,window,document);